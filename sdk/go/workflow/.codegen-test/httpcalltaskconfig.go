// Code generated by stigmer-codegen. DO NOT EDIT.
// Source: httpcalltaskconfig.go
// Generated: 2026-01-23T21:42:22+05:30

package workflow

import (
	"google.golang.org/protobuf/types/known/structpb"
)

// HTTP_CALL tasks make HTTP requests (GET, POST, PUT, DELETE, PATCH).
type HttpCallTaskConfig struct {
	// HTTP method (GET, POST, PUT, DELETE, PATCH)
	Method string `json:"method,omitempty"`
	// HTTP endpoint URI
	URI string `json:"uri,omitempty"`
	// HTTP headers (optional). Values can contain expressions: "Bearer ${TOKEN}"
	Headers map[string]string `json:"headers,omitempty"`
	// Request body (optional). Can be any JSON structure. Supports expressions in string values.
	Body map[string]interface{} `json:"body,omitempty"`
	// Request timeout in seconds (optional, default: 30)
	TimeoutSeconds int32 `json:"timeout_seconds,omitempty"`
}

// isTaskConfig marks HttpCallTaskConfig as a TaskConfig implementation.
func (c *HttpCallTaskConfig) isTaskConfig() {}

// ToProto converts HttpCallTaskConfig to google.protobuf.Struct for proto marshaling.
func (c *HttpCallTaskConfig) ToProto() (*structpb.Struct, error) {
	data := make(map[string]interface{})

	data["method"] = c.Method
	data["uri"] = c.URI
	if !isEmpty(c.Headers) {
		data["headers"] = c.Headers
	}
	if !isEmpty(c.Body) {
		data["body"] = c.Body
	}
	if !isEmpty(c.TimeoutSeconds) {
		data["timeout_seconds"] = c.TimeoutSeconds
	}

	return structpb.NewStruct(data)
}

// FromProto converts google.protobuf.Struct to HttpCallTaskConfig.
func (c *HttpCallTaskConfig) FromProto(s *structpb.Struct) error {
	fields := s.GetFields()

	if val, ok := fields["method"]; ok {
		c.Method = val.GetStringValue()
	}

	if val, ok := fields["uri"]; ok {
		c.URI = val.GetStringValue()
	}

	if val, ok := fields["headers"]; ok {
		c.Headers = make(map[string]string)
		for k, v := range val.GetStructValue().GetFields() {
			c.Headers[k] = v.GetStringValue()
		}
	}

	if val, ok := fields["body"]; ok {
		c.Body = val.GetStructValue().AsMap()
	}

	if val, ok := fields["timeout_seconds"]; ok {
		c.TimeoutSeconds = int32(val.GetNumberValue())
	}

	return nil
}

// HttpCallOption is a functional option for configuring a HTTP_CALL task.
type HttpCallOption func(*HttpCallTaskConfig)

// HttpCall creates a HTTP_CALL task with functional options.
//
// Example:
//
//	task := HttpCall("my-task",
//	    Method(...),
//	    URI(...),
//	)
func HttpCall(name string, opts ...HttpCallOption) *Task {
	config := &HttpCallTaskConfig{
		Headers: make(map[string]string),
	}

	// Apply all options
	for _, opt := range opts {
		opt(config)
	}

	return &Task{
		Name:   name,
		Kind:   TaskKindHttpCall,
		Config: config,
	}
}

// Method sets the http method (get, post, put, delete, patch).
//
// Accepts:
//   - String literal: "value"
//   - Expression: "${.variable}"
//
// Example:
//
//	Method("example-value")
//	Method("${.config.value}")
func Method(value interface{}) HttpCallOption {
	return func(c *HttpCallTaskConfig) {
		c.Method = coerceToString(value)
	}
}

// URI sets the http endpoint uri.
//
// Accepts:
//   - String literal: "value"
//   - Expression: "${.variable}"
//
// Example:
//
//	URI("example-value")
//	URI("${.config.value}")
func URI(value interface{}) HttpCallOption {
	return func(c *HttpCallTaskConfig) {
		c.URI = coerceToString(value)
	}
}

// Body sets the request body (optional). can be any json structure. supports expressions in string values..
//
// Example:
//
//	Body(map[string]interface{}{
//	    "key": "value",
//	})
func Body(value map[string]interface{}) HttpCallOption {
	return func(c *HttpCallTaskConfig) {
		c.Body = value
	}
}

// TimeoutSeconds sets the request timeout in seconds (optional, default: 30).
//
// Example:
//
//	TimeoutSeconds(30)
func TimeoutSeconds(value int32) HttpCallOption {
	return func(c *HttpCallTaskConfig) {
		c.TimeoutSeconds = value
	}
}
