// Code generated by stigmer-codegen. DO NOT EDIT.
// Generated: 2026-01-24T10:27:08+05:30

package workflow

import (
	"fmt"
	"reflect"
)

// IsEmpty checks if a value is empty/zero.
// Used by ToProto methods to skip optional fields.
func IsEmpty(v interface{}) bool {
	if v == nil {
		return true
	}
	val := reflect.ValueOf(v)
	return val.IsZero()
}

// isEmpty is an alias for backward compatibility
var isEmpty = IsEmpty

// CoerceToString converts various types to strings for expression support.
// Used by option functions to accept both string literals and expressions.
func CoerceToString(value interface{}) string {
	if s, ok := value.(string); ok {
		return s
	}
	// Handle *Task - convert to task reference expression
	if task, ok := value.(*Task); ok {
		return fmt.Sprintf("${ $context[\"%s\"] }", task.Name)
	}
	// Handle StringRef - use Value() for resolved literals, Expression() for computed
	if sr, ok := value.(interface {
		Value() string
		Expression() string
	}); ok {
		// Try Value() first (for resolved StringRef from Concat, etc.)
		if v := sr.Value(); v != "" {
			return v
		}
		// Fall back to Expression() for computed/context refs
		return sr.Expression()
	}
	// Handle TaskFieldRef and other expression types
	if expr, ok := value.(interface{ Expression() string }); ok {
		return expr.Expression()
	}
	return fmt.Sprintf("%v", value)
}
