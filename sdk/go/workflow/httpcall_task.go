// Code generated by stigmer-codegen. DO NOT EDIT.
// Source: httpcall_task.go
// Generated: 2026-01-22T08:27:20+05:30

package workflow

import (
	"google.golang.org/protobuf/types/known/structpb"
)

// HTTP_CALL tasks make HTTP requests (GET, POST, PUT, DELETE, PATCH).
type HttpCallTaskConfig struct {
	// HTTP method (GET, POST, PUT, DELETE, PATCH)
	Method string `json:"method,omitempty"`
	// HTTP endpoint URI
	URI string `json:"uri,omitempty"`
	// HTTP headers (optional). Values can contain expressions: "Bearer ${TOKEN}"
	Headers map[string]string `json:"headers,omitempty"`
	// Request body (optional). Can be any JSON structure. Supports expressions in string values.
	Body map[string]interface{} `json:"body,omitempty"`
	// Request timeout in seconds (optional, default: 30)
	TimeoutSeconds int32 `json:"timeout_seconds,omitempty"`
}

// isTaskConfig marks HttpCallTaskConfig as a TaskConfig implementation.
func (c *HttpCallTaskConfig) isTaskConfig() {}

// HttpCallTask creates a Http Call workflow task.
//
// Parameters:
//   - name: Task name (must be unique within workflow)
//   - method: HTTP method (GET, POST, PUT, DELETE, PATCH)
//   - uRI: HTTP endpoint URI
//   - headers: HTTP headers (optional). Values can contain expressions: "Bearer ${TOKEN}"
//   - body: Request body (optional). Can be any JSON structure. Supports expressions in string values.
//   - timeoutSeconds: Request timeout in seconds (optional, default: 30)
func HttpCallTask(name string, method string, uRI string, headers map[string]string, body map[string]interface{}, timeoutSeconds int32) *Task {
	return &Task{
		Name: name,
		Kind: TaskKindHttpCall,
		Config: &HttpCallTaskConfig{
			Method:         method,
			URI:            uRI,
			Headers:        headers,
			Body:           body,
			TimeoutSeconds: timeoutSeconds,
		},
	}
}

// ToProto converts HttpCallTaskConfig to google.protobuf.Struct for proto marshaling.
func (c *HttpCallTaskConfig) ToProto() (*structpb.Struct, error) {
	data := make(map[string]interface{})

	data["method"] = c.Method
	data["uri"] = c.URI
	if !isEmpty(c.Headers) {
		data["headers"] = c.Headers
	}
	if !isEmpty(c.Body) {
		data["body"] = c.Body
	}
	if !isEmpty(c.TimeoutSeconds) {
		data["timeout_seconds"] = c.TimeoutSeconds
	}

	return structpb.NewStruct(data)
}

// FromProto converts google.protobuf.Struct to HttpCallTaskConfig.
func (c *HttpCallTaskConfig) FromProto(s *structpb.Struct) error {
	fields := s.GetFields()

	if val, ok := fields["method"]; ok {
		c.Method = val.GetStringValue()
	}

	if val, ok := fields["uri"]; ok {
		c.URI = val.GetStringValue()
	}

	if val, ok := fields["headers"]; ok {
		c.Headers = make(map[string]string)
		for k, v := range val.GetStructValue().GetFields() {
			c.Headers[k] = v.GetStringValue()
		}
	}

	if val, ok := fields["body"]; ok {
		c.Body = val.GetStructValue().AsMap()
	}

	if val, ok := fields["timeout_seconds"]; ok {
		c.TimeoutSeconds = int32(val.GetNumberValue())
	}

	return nil
}
