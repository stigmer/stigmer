syntax = "proto3";

package ai.stigmer.iam.iampolicy.v1.rpcauthorization;

// ApiResourceIamPermission defines the core permissions used in the authorization model.
// This is a simplified set for a demo project, containing only essential permissions.
enum ApiResourceIamPermission {
  unspecified = 0;

  // Basic CRUD permissions
  create = 1;
  can_delete = 2;
  can_view = 3;
  can_edit = 4;

  // Platform-level permissions
  operator = 5; // Platform operator with elevated privileges
  platform = 6; // Platform-level access
  login_to_back_office = 7; // Permission to login to back office

  // IAM policy management permissions (follows can_* pattern)
  can_grant_access = 8; // Permission to grant/revoke access (create/delete IAM policies)
  can_view_access = 9; // Permission to view who has access (view IAM policies)

  // Resource ownership and membership
  owner = 10; // Resource owner
  member = 11; // Resource member (for teams, organizations)

  // Structural relations (parent links)
  identity_account = 12; // Link to identity account (user-scoped parent)
  organization = 13; // Link to organization (org-scoped parent)
  session = 14; // Link to session (agent execution parent)
  agent = 15; // Link to agent (agent instance parent)

  // Resource-specific creation permissions
  can_create_agent = 16; // Permission to create agents in an organization
  can_create_workflow = 17; // Permission to create workflows in an organization
  can_create_session = 18; // Permission to create sessions in an organization
  can_create_execution_in = 19; // Permission to create agent executions in a session
  can_create_instance = 20; // Permission to create agent instances (derived from can_execute on parent agent)
  can_create_skill = 21; // Permission to create skills in an organization

  // Resource-specific operation permissions
  can_execute = 22; // Permission to execute agent/session operations
}
