syntax = "proto3";

package ai.stigmer.iam.apikey.v1;

import "ai/stigmer/commons/apiresource/field_options.proto";
import "google/protobuf/timestamp.proto";

//api-key spec
message ApiKeySpec {
  // SHA-256/Bcrypt hash of the raw key generated by the system during.
  // the system returns the actual key in this field in create response but the
  // actual key itself is never persisted in the database.
  //only the last 6 chars of the key are persisted in the fingerprint field for UI presentation.
  string key_hash = 1 [(ai.stigmer.commons.apiresource.computed) = true];
  // UI-visible fingerprint (e.g. last 6 chars)
  string fingerprint = 2 [(ai.stigmer.commons.apiresource.computed) = true];

  // absolute expiry time (null if neverExpires = true)
  google.protobuf.Timestamp expires_at = 3;

  // never expire flag (forces expires_at to be ignored)
  bool never_expires = 4;
}
