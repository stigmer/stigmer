syntax = "proto3";

package ai.stigmer.agentic.skill.v1;

import "ai/stigmer/agentic/skill/v1/spec.proto";
import "ai/stigmer/agentic/skill/v1/status.proto";
import "ai/stigmer/commons/apiresource/metadata.proto";
import "buf/validate/validate.proto";

// Skill represents a versioned, reusable unit of agent capability.
// Skills contain tools, scripts, and documentation that agents can use.
// Each skill version is immutably identified by a content hash.
message Skill {
  // API version for this resource type.
  string api_version = 1 [(buf.validate.field).string.const = 'agentic.stigmer.ai/v1'];

  // Resource kind identifier.
  string kind = 2 [(buf.validate.field).string.const = 'Skill'];

  // Standard resource metadata including name, id, labels, and tags.
  // Skill names are normalized to slugs (e.g., "Calculator" â†’ "calculator")
  ai.stigmer.commons.apiresource.ApiResourceMetadata metadata = 3 [
    (buf.validate.field).required = true,
    (buf.validate.field).cel = {
      id: "skill.owner_scope.platform_or_org_only"
      message: "Skill resources can only have platform or organization scope"
      expression: "this.owner_scope == 1 || this.owner_scope == 2"
    }
  ];

  // User-provided skill configuration (desired state).
  SkillSpec spec = 4;

  // System-managed skill state (observed state).
  SkillStatus status = 5;
}

// SkillList represents a paginated list of skills.
message SkillList {
  // API version for this list type.
  string api_version = 1;

  // Resource kind identifier for the list.
  string kind = 2;

  // List of skill resources.
  repeated Skill items = 3;
}
